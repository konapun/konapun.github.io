<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[konapun.github.io]]></title><description><![CDATA[Personal site for Bremen Braun (@konapun)]]></description><link>http://konapun.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Wed, 03 Feb 2021 04:10:56 GMT</lastBuildDate><item><title><![CDATA[Ideas For a New Templating Language]]></title><description><![CDATA[ALL INFO IS BRAINSTORMING AND SUBJECT TO CHANGE Like many self-proclaimed techies, especially those with an affinity for Linux, I enjoy…]]></description><link>http://konapun.github.io/ideas-for-a-new-templating-language/</link><guid isPermaLink="false">http://konapun.github.io/ideas-for-a-new-templating-language/</guid><pubDate>Thu, 12 Nov 2020 21:23:12 GMT</pubDate><content:encoded>&lt;p&gt;&lt;strong&gt;ALL INFO IS BRAINSTORMING AND SUBJECT TO CHANGE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Like many self-proclaimed techies, especially those with an affinity for Linux, I enjoy tinkering. Particularly, I like tinkering with my development config and modifying &lt;a href=&quot;https://github.com/konapun/dotfiles&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;my dotfiles&lt;/a&gt;
and in the process have wanted to make my configuration configurable as well (themability!).&lt;/p&gt;
&lt;p&gt;I’ve added a rudimentary sed-based templating system to make my dotfiles configurable and while it works,
it just feels… messy somehow. The files themselves are no longer usable without running through my install
script as the template pieces aren’t valid syntax in any of the various files.&lt;/p&gt;
&lt;h2&gt;Requirements for a Solution&lt;/h2&gt;
&lt;p&gt;As I require the dotfile to be a standalone config file, the new templating system (henceforth referred to as &lt;code class=&quot;language-text&quot;&gt;Cactus&lt;/code&gt; for reasons which will be explained later) should consist of markup which
is combined with the dotfile itself to generate a template.&lt;/p&gt;
&lt;p&gt;As a second requirement, I want to be able to develop this sytem somewhat quickly and only want to create a barebones DSL for markup and have the majority of the logic take place within the piece
that acts on the template which was generated by the informed config file (config data + markup). For this reason, Cactus should have a robust API for interacting with the compiled file.
This is CaCtus - &lt;strong&gt;Code as Configuration&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Cactus config should act as a tree. There should be a root config file, containing things like language extensions, global variables, and files to process, and each file to process is recursively
its own config file. The root config should live at &lt;code class=&quot;language-text&quot;&gt;~/.config/cactus/cactus.json&lt;/code&gt; (probably JSON since this will most likely use Node.js for reasons given in &lt;strong&gt;Other Bells and Whistles&lt;/strong&gt; below).&lt;/p&gt;
&lt;p&gt;Cactus needs a cache. Since Cactus files are compiled into a template, this compilation should only occur as needed so the compiled version should be cached. Cache invalidation will either occur
by checking the last modified date on the source file and compiled file and recompiling if necessary or by manual compilation as desired through use of the driver program.&lt;/p&gt;
&lt;p&gt;Cactus will have a driver program. This program will allow control over compilation and the daemon (ooh, spooky). More on daemon throughts below.&lt;/p&gt;
&lt;h3&gt;Bonus&lt;/h3&gt;
&lt;p&gt;An ambitous bonus would be an event simpler markup system using heuristics to generate a compiled Cactus file (e.g. using spacing and comments to determine blocks, etc). While less powerful than
Cactus markup, the host language API would be able to pick up the slack to achieve the same functionality. While this is probably technically feasible, it’s not without its downsides.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Pros:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cleaner config files&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Imperfect heuristics will require more frequent updates&lt;/li&gt;
&lt;li&gt;Configuration processing logic is moved from compile time to runtime&lt;/li&gt;
&lt;li&gt;Configuration processing lives spatially further from the configuration it acts on leading to a greater penchant for Cactus to get out of sync with its config file&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Rundown&lt;/h2&gt;
&lt;p&gt;After installing Cactus and adding the necessary config, the &lt;code class=&quot;language-text&quot;&gt;cactus&lt;/code&gt; binary will be used to compile a template from the config:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;cactus compile # reads config in ~/.cactus/cactus.json and runs compilation based on config&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If there were no compilation errors, template files will have been added to the Cactus cache. The &lt;code class=&quot;language-text&quot;&gt;cactus&lt;/code&gt; binary can now act on the templates to write a config. This step runs the Javascript files that
use the Cactus API to interact with the template files.&lt;/p&gt;
&lt;p&gt;In this example, the Javascript files specified a global variable called &lt;code class=&quot;language-text&quot;&gt;theme&lt;/code&gt;. The user has tied the value of this variable to a config object which specifies downstream configuration values for
various programs which are themable.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;cactus set theme nord&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Afer this step, the new dotfiles have been written. Note that running &lt;code class=&quot;language-text&quot;&gt;cactus compile&lt;/code&gt; at this point would compile the newly created dotfiles into a new template (though if this turns out to not be the
desired behavior we could cache SHAs of the template files to check whether they were modified by a user since being written).&lt;/p&gt;
&lt;h2&gt;Markdown Considerations&lt;/h2&gt;
&lt;p&gt;In order to avoid polluting the config file it lives in it should be placed within comments and use unambiguous start tags as to avoid having to deal with escape sequences. It should be simple but
powerful; it needs to be able to instruct the compiler how to generate tokens from a config file of any syntax.&lt;/p&gt;
&lt;p&gt;But how do I know ahead of time how powerful this system needs to be? Well, I don’t know and because of that I need a simple yet powerful SYNTAX (for sure I’m thinking Scheme!). I should aim to make
available a good set of functions for use within the cactus template for interacting with the config file. For those things I don’t think of that others may need, I’ll create a Javascript extension
API to allow others to use Javascript to export functions for use within Cactus templates.&lt;/p&gt;
&lt;p&gt;As stated earlier, a Javascript API will act on the compiled template. To inform the API of available actions on a Cactus node, Cactus nodes will be typed. I foresee there being at least three types
and more likely four or more:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Variables&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allow replacing a value&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sections&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allow portions of the configuration to be turned on/off (for instance, if you want to keep separate profiles for Mac and Linux in the same file and only enable one at a time)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Switches&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allow a single option to be selected from a list of many (for instance, if you had multiple Plug themes listed in your config file but only wanted one installed at a time you could list them all but comment all but one)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Example&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;vim&quot;&gt;&lt;pre class=&quot;language-vim&quot;&gt;&lt;code class=&quot;language-vim&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;&quot; @cactus variable colorscheme {(extract-from &lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;nord&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;colorscheme&lt;/span&gt; nord

&lt;span class=&quot;token comment&quot;&gt;&quot; @cactus section lisp begin&lt;/span&gt;
Plug &lt;span class=&quot;token string&quot;&gt;&apos;guns/vim-sexp&apos;&lt;/span&gt;
Plug &lt;span class=&quot;token string&quot;&gt;&apos;tpope/vim-sexp-mappings-for-regular-people&apos;&lt;/span&gt;
Plug &lt;span class=&quot;token string&quot;&gt;&apos;Olical/conjure&apos;&lt;/span&gt;
Plug &lt;span class=&quot;token string&quot;&gt;&apos;clojure-vim/vim-jack-in&apos;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;&quot; @cactus end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; cactus &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@cactus/core&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;cactus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./init.vim&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;colorscheme&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;gruvbox&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lisp&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Supported Use Cases&lt;/h2&gt;
&lt;h3&gt;Keeping Static Config Files&lt;/h3&gt;
&lt;p&gt;If you keep a repo of your dotfiles, the most common use case is to maintain the static version of your config and use Cactus to modify portions of it, such as generating a theme.&lt;/p&gt;
&lt;h3&gt;Using Generated Files as Input Files&lt;/h3&gt;
&lt;p&gt;If you like to live on the edge, you may just have your single set of dotfiles not stored in a repo. If this is the case, you can still use Cactus. Rather than using static files from a repo as input,
Cactus can act on the dotfiles, compile a template, and then run Cactus actions on that template to replace the initial input file. If you decide to go this route be sure not to reference data which may
be altered by Cactus (such as extracting a value to a variable which may change based on dynamic configuration)!&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;cactus compile&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Proposed Configuration Structures&lt;/h2&gt;
&lt;p&gt;There are three main files involved in a Cactus configuration: a main Cactus config file, a config file with cactus templates, and a javascript file which acts on the template.&lt;/p&gt;
&lt;p&gt;I’ll consider two different structures for organizing a Cactus-federated configuration suite: Centralized and Distributed organization&lt;/p&gt;
&lt;h3&gt;Centralized&lt;/h3&gt;
&lt;p&gt;In a centralized configuration, Cactus-specific files reside in a single place (everything aside from Cactus templates which still go in the corresponding files they act on).&lt;/p&gt;
&lt;h3&gt;Distributed&lt;/h3&gt;
&lt;p&gt;In a distributed configuration, Cactus-specific files (i.e. the Node files which utilize the Cactus API) live alongside the config files for the various programs being configured.&lt;/p&gt;
&lt;h2&gt;Other Bells and Whistles&lt;/h2&gt;
&lt;p&gt;Since this may already be the most overengineered configuration solution ever conceived, let’s go one step further and add a “killer feature”.&lt;/p&gt;
&lt;p&gt;With other config systems you usually have a single point of control. If you want to change a theme, you need to go through the right place to apply that theme everywhere (e.g. changing your alacritty
theme will not also change your vim theme). What if updating any of your configs also applied changes elsewhere?&lt;/p&gt;
&lt;p&gt;Enter the Cactus Daemon. This will watch target files for changes and propogate related changes to other configurations in the Cactus federation. I haven’t thought through this much yet so additional
ideas will be forthcoming (or more likely, abandoned) as the project progresses.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Using Proxy Objects]]></title><description><![CDATA[Recently, someone asked on a programming subreddit if there was a way in a node
Express app to reduce duplicated error handling logic when…]]></description><link>http://konapun.github.io/using-proxy-objects/</link><guid isPermaLink="false">http://konapun.github.io/using-proxy-objects/</guid><pubDate>Tue, 16 Jun 2020 22:18:34 GMT</pubDate><content:encoded>&lt;p&gt;Recently, someone asked on a programming subreddit if there was a way in a node
Express app to reduce duplicated error handling logic when specifying route handlers.&lt;/p&gt;
&lt;p&gt;There are a number of good Express-provided ways or design solutions to address this issue
but I wondered if I could come up with a solution using a Proxy.&lt;/p&gt;
&lt;p&gt;The gist of the problem was this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; express &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;express&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; router &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; express&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Router&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/one&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;some_code_which_may_throw_an_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// code which may throw errors, including database operations&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/two&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;some_more_code_which_may_throw_an_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// code which may throw errors, including database operations&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// and so on...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Those of you that are familiar with Express may know about custom middleware that
could be used to handle errors in a uniform way and I agree that this is the better
solution. However, the point of this for me was more of a puzzle.&lt;/p&gt;
&lt;h2&gt;What is a Proxy in Javascript?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;Proxies&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy&lt;/a&gt; were added
in ES6 as a way of specifying traps for an object. That is, ways you can hook into a defined object to
intercept calls and provide your own code to run. There are many practical uses for proxies but here we’ll
be using it as a tool to solve the problem stated above.&lt;/p&gt;
&lt;h2&gt;A Solution&lt;/h2&gt;
&lt;p&gt;Given what we know about proxies, we can see a potential solution in trapping the route handler and adding
the error handling there. Let’s design our solution as a wrapper function called &lt;code class=&quot;language-text&quot;&gt;proxyRouter&lt;/code&gt; which takes
an Express router:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;proxyRouter&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;router&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Proxy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;router&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prop&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;get&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;put&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;post&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;patch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;delete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;route&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;route&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h3&gt;Let’s break it down!&lt;/h3&gt;
&lt;p&gt;The first thing to notice is our Proxy definition. The first argument to Proxy is the &lt;code class=&quot;language-text&quot;&gt;target&lt;/code&gt; object we want
to proxy, which is the Express router. The second argument is the &lt;code class=&quot;language-text&quot;&gt;handler&lt;/code&gt; which specifies our hooks. &lt;code class=&quot;language-text&quot;&gt;get&lt;/code&gt;
is invoked upon property access on our target which includes methods as well. Here, &lt;code class=&quot;language-text&quot;&gt;target&lt;/code&gt; is our object and
&lt;code class=&quot;language-text&quot;&gt;prop&lt;/code&gt; is the property being accessed.&lt;/p&gt;
&lt;p&gt;For our purposes, we want to provide our own implementations for all the HTTP verbs while leaving any other
properties untouched:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;get&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;put&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;post&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;patch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;delete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But if the property IS an HTTP verb, we need to return a new function which includes our extra logic. Remember
that the signature for &lt;code class=&quot;language-text&quot;&gt;router.post&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;router.put&lt;/code&gt;, etc. is &lt;code class=&quot;language-text&quot;&gt;(route, handler)&lt;/code&gt; which we can see in the specification
of the original problem at the beginning of this post. We want to provide an alternate implementation for this
function that includes the error handling bits we care about:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;route&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;route&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// This is the handler function the user passes&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h3&gt;Using our proxy object&lt;/h3&gt;
&lt;p&gt;So how would we use this? Easy!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; router &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;proxyRouter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;express&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Router&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;some_code_which_may_throw_an_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// We no longer need to put it in a try/catch!&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It works!&lt;/p&gt;
&lt;p&gt;Because the call to &lt;code class=&quot;language-text&quot;&gt;post&lt;/code&gt; is running through the proxy, error handling is already taken care of!&lt;/p&gt;
&lt;p&gt;Again, this isn’t necessarily the best solution but it’s definitely a problem that can be solved using a
Proxy and Proxies are awesome!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Introducing Orbital Frame]]></title><description><![CDATA[After years of on and off work, Orbital Frame has been released to npm as an alpha! For full details, check out the GitHub repo and try an…]]></description><link>http://konapun.github.io/introducing-orbital-frame/</link><guid isPermaLink="false">http://konapun.github.io/introducing-orbital-frame/</guid><pubDate>Fri, 15 May 2020 23:28:02 GMT</pubDate><content:encoded>&lt;p&gt;After years of on and off work, Orbital Frame has been &lt;a href=&quot;https://www.npmjs.com/package/@orbital-frame/core&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;released to npm&lt;/a&gt; as an alpha!&lt;/p&gt;
&lt;p&gt;For full details, check out the &lt;a href=&quot;https://github.com/konapun/orbital-frame&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;GitHub repo&lt;/a&gt; and try an &lt;a href=&quot;/projects/orbital-frame&quot;&gt;online demo&lt;/a&gt;!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Hello World]]></title><description><![CDATA[Figured I’d throw a quick site together to host project demos. This site is
powered by Gatsby and is based on a modified mashup of
gatsby…]]></description><link>http://konapun.github.io/hello-world/</link><guid isPermaLink="false">http://konapun.github.io/hello-world/</guid><pubDate>Sun, 19 Apr 2020 03:55:25 GMT</pubDate><content:encoded>&lt;p&gt;Figured I’d throw a quick site together to host project demos. This site is
powered by Gatsby and is based on a modified mashup of
&lt;a href=&quot;https://www.gatsbyjs.org/starters/anubhavsrivastava/gatsby-starter-resume/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;gatsby-starter-resume&lt;/a&gt; and
&lt;a href=&quot;https://www.gatsbyjs.org/starters/gatsbyjs/gatsby-starter-blog/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;gatsby-starter-blog&lt;/a&gt;
with some (ongoing) improvements in usability and code quality.&lt;/p&gt;
&lt;p&gt;This site is strictly utilitarian; I’m a web developer in my daily job but my
hobbyist projects tend to be more CLI/framework oriented. As a result, this site
isn’t meant to be a showcase of my webdev skills so please keep that in mind if
you’re browsing this site’s source code.&lt;/p&gt;</content:encoded></item></channel></rss>